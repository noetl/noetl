version: '3.45'

tasks:
  analytics:k8s:deploy:
    desc: Deploy analytics stack (Apache Superset + JupyterLab) to kind cluster
    aliases: [da, deploy-analytics]
    cmds:
      - task: kubectl:local:context-set-kind
      - kubectl apply -f ci/manifests/analytics/namespace.yaml
      - kubectl apply -f ci/manifests/analytics/superset/
      - kubectl apply -f ci/manifests/analytics/jupyterlab/

  analytics:k8s:remove:
    desc: Remove analytics stack (Superset + JupyterLab) from kind cluster
    aliases: [ra, remove-analytics]
    cmds:
      - task: kubectl:local:context-set-kind
      - kubectl delete -f ci/manifests/analytics/jupyterlab/ || true
      - kubectl delete -f ci/manifests/analytics/superset/ || true
      - kubectl delete -f ci/manifests/analytics/namespace.yaml || true
