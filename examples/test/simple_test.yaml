apiVersion: noetl.io/v1
kind: Playbook
name: simple_test
path: examples/test/simple_test

workload:
  message: "Hello World"

workflow:
  - step: start
    desc: "Start simple test"
    next:
      - step: test_step
        data:
          message: "{{ workload.message }}"

  - step: test_step
    desc: "Simple test step"
    type: python
    code: |
      def main(message):
          print(f"TEST_STEP: {message}")
          return {"result": "success", "message": message}
    next:
      - step: end

  - step: end
    desc: "End simple test"
    save:
      storage: {kind: postgres,  spec: {db_host: "localhost", db_port: "5432", db_user: "demo", db_password: "", db_name: "demo_noetl"}}
      data: {hello_world_step: "{{ test_step.data }}"}
